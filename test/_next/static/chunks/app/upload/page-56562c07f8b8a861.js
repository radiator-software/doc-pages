(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5994],{34860:(e,l,t)=>{"use strict";function r(e,l){if(null==e)throw Error(null!=l?l:"Value must not be null or undefined")}t.d(l,{B:()=>r})},35208:()=>{},42363:()=>{},50310:()=>{},60149:(e,l,t)=>{"use strict";t.d(l,{T:()=>n});var r=t(95155),a=t(12115),i=t(29767),s=t(2821);let n=a.forwardRef(function(e,l){let{className:t,...a}=e;return(0,r.jsx)("div",{className:"overflow-y-visible",children:(0,r.jsx)(i.default,{ref:l,className:(0,s.A)(t,"overflow-x-auto"),...a})})});n.displayName="OverflowingCard"},77809:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>B});var r=t(95155),a=t(84544),i=t(84609),s=t(34860),n=t(89489),c=t(95127),d=t(545),o=t(36741),u=t(12857),f=t(60149),x=t(64792),h=t(71356),v=t(25957),j=t(84578),m=t(52641),p=t(51221),b=t(55606),A=t(86973),y=t(61023),g=t(70690),C=t(25635),w=t(21067),N=t(16963),S=t(2456),k=t(45202),T=t(12115);let F=(0,c.A)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),E=e=>(0,r.jsxs)(x.A,{children:[(0,r.jsx)(h.A,{children:e.title}),(0,r.jsx)(h.A,{children:(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[e.icon,(0,r.jsx)("pre",{className:"my-0",children:e.value})]})})]}),B=()=>{var e,l,t,c,B;let I=(0,n.JN)(),[_,D]=(0,T.useState)(null),[R,P]=(0,T.useState)(),[U,O]=(0,T.useState)(""),[V,W]=(0,T.useState)("license"),[L,K]=(0,T.useState)(""),[z,G]=(0,T.useState)(),J=(0,T.useCallback)(e=>{var l;let t=null==(l=e.target.files)?void 0:l[0];if(P(t),!t)return;let r=new FileReader;r.onload=()=>{G(r.result)},r.readAsArrayBuffer(t)},[]),X=(0,T.useCallback)(e=>{W(e.target.value)},[]),q=(0,T.useCallback)(e=>{O(e.target.value)},[]),H=(0,T.useCallback)(e=>{K(e.target.value)},[]),M=async e=>{e.preventDefault();let l=new FormData(e.currentTarget),t={kind:V};""!==U&&(t.subdir=U),D(await I.post("files/upload",{body:l,searchParams:t}).json())},Q=[],Y=null,Z=null==R||null==(e=R.name)?void 0:e.endsWith(".p12");if(z&&("certificate"===V||"ca_certificate"===V)){let e;Q=null!=(c=(e=Z?((e,l)=>{try{let t=new i.util.ByteStringBuffer(e),r=i.asn1.fromDer(t),a=i.pkcs12.pkcs12FromAsn1(r,l).getBags({bagType:i.pki.oids.certBag}),n=Object.keys(a)[0];return(0,s.B)(n,"No certificates found in PKCS#12 file"),{certs:a[n]?a[n].map(e=>e.cert).filter(e=>void 0!==e):[]}}catch(e){return{error:e,certs:[]}}})(z,L):(null==R||null==(l=R.name)?void 0:l.endsWith(".der"))?(e=>{try{let l=new i.util.ByteStringBuffer(e),t=i.asn1.fromDer(l);return{certs:[i.pki.certificateFromAsn1(t)]}}catch(e){return{error:e,certs:[]}}})(z):(null==R||null==(t=R.name)?void 0:t.endsWith(".pem"))?(e=>{try{return{certs:i.pem.decode(e).filter(e=>["CERTIFICATE","X509 CERTIFICATE","TRUSTED CERTIFICATE"].includes(e.type)).map(e=>i.asn1.fromDer(e.body)).map(e=>i.pki.certificateFromAsn1(e))}}catch(e){return{error:e,certs:[]}}})(new TextDecoder().decode(z)):{error:"Unsupported file type",certs:[]}).certs)?c:[],e.error&&(Y=e.error.message?e.error.message:null!=(B=e.error)?B:null)}return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)(f.T,{children:[(0,r.jsx)(v.default,{title:"Upload file"}),(0,r.jsx)(j.default,{children:(0,r.jsxs)("form",{className:"flex flex-col gap-4 items-start",onSubmit:M,encType:"multipart/form-data",method:"post",children:[(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsxs)(m.A,{children:[(0,r.jsx)(p.A,{id:"file-type-label",children:"File type"}),(0,r.jsxs)(b.A,{labelId:"file-type-label",value:V,label:"File type",onChange:X,children:[(0,r.jsx)(A.A,{value:"license",children:"License"}),(0,r.jsx)(A.A,{value:"certificate",children:"Certificate"}),(0,r.jsx)(A.A,{value:"private_key",children:"Private key"}),(0,r.jsx)(A.A,{value:"ca_certificate",children:"CA certificate"})]})]}),"license"!==V&&(0,r.jsx)(y.A,{value:U,onChange:q,label:"Sub-directory",variant:"outlined"})]}),(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsxs)(g.default,{component:"label",variant:"contained",tabIndex:-1,startIcon:(0,r.jsx)(d.A,{}),color:"inherit",children:["Select file",(0,r.jsx)(F,{type:"file",name:"file",onChange:J})]}),null==R?void 0:R.name]}),(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)(g.default,{type:"submit",color:"primary",variant:"contained",children:"Upload"}),(0,r.jsx)("div",{children:null==_?void 0:_.message})]})]})})]}),("certificate"===V||"ca_certificate"===V)&&(0,r.jsxs)(f.T,{children:[(0,r.jsx)(v.default,{title:"Certificate chain details"}),Z&&(0,r.jsx)(j.default,{children:(0,r.jsx)(a.y,{value:L,onChange:H,label:"PKCS #12 password",variant:"outlined",autoComplete:"new-password"})}),Y&&(0,r.jsx)(j.default,{children:(0,r.jsxs)(C.default,{variant:"body1",color:"error",children:["Error: ",Y]})}),void 0===R&&(0,r.jsx)(j.default,{children:(0,r.jsx)(C.default,{variant:"body1",children:"Upload a certificate file to see details."})}),(null!=Q?Q:[]).map((e,l)=>{var t,a,i;let s=null!=e&&null!=(t=e.validity)&&!!t.notBefore&&e.validity.notBefore>new Date,n=null!=e&&null!=(a=e.validity)&&!!a.notAfter&&e.validity.notAfter<new Date;return(0,r.jsxs)(T.Fragment,{children:[(0,r.jsx)(w.default,{}),(0,r.jsx)(v.default,{title:"Certificate:",className:"pb-0"}),(n||s)&&(0,r.jsx)(j.default,{children:(0,r.jsx)(C.default,{variant:"body1",color:"error",children:"WARNING: The certificate might be invalid. Review details below."})}),(0,r.jsx)(j.default,{className:"ml-4 mb-4",children:(0,r.jsxs)(N.A,{size:"small",children:[(0,r.jsx)(S.A,{children:(0,r.jsxs)(x.A,{children:[(0,r.jsx)(h.A,{children:"Field"}),(0,r.jsx)(h.A,{children:"Value"})]})}),(0,r.jsxs)(k.A,{children:[(0,r.jsx)(E,{title:"Issuer",value:e.issuer.getField("CN").value}),(0,r.jsx)(E,{title:"Subject",value:e.subject.getField("CN").value}),(0,r.jsx)(E,{title:"Valid after",value:e.validity.notBefore.toLocaleString(),icon:s?(0,r.jsx)(u.A,{color:"error"}):(0,r.jsx)(o.A,{})}),(0,r.jsx)(E,{title:"Valid until",value:e.validity.notAfter.toLocaleString(),icon:n?(0,r.jsx)(u.A,{color:"error"}):(0,r.jsx)(o.A,{})}),(0,r.jsx)(E,{title:"Subject alt names",value:null==(i=e.getExtension({name:"subjectAltName"}))?void 0:i.altNames.map(e=>{var l;return null!=(l=e.ip)?l:e.value}).join("\n")})]})]})})]},l)})]})]})}},89369:(e,l,t)=>{Promise.resolve().then(t.bind(t,77809))}},e=>{e.O(0,[9140,4854,5070,8548,870,2378,4614,7097,3202,4180,1023,2677,7856,7210,8441,1255,7358],()=>e(e.s=89369)),_N_E=e.O()}]);