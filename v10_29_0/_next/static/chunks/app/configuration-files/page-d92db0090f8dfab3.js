(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6233],{5333:(e,n,t)=>{Promise.resolve().then(t.bind(t,42191)),Promise.resolve().then(t.bind(t,29767)),Promise.resolve().then(t.bind(t,84578)),Promise.resolve().then(t.bind(t,25957))},23778:(e,n,t)=>{"use strict";t.d(n,{S:()=>u});var a=t(95155),i=t(70690),l=t(12115),s=t(86946),r=t(545),o=t(78095),c=t(77073),d=t(2821);let u=e=>{let[n,t]=(0,l.useState)(!1),[u,h]=(0,l.useState)([]),f=(0,l.useRef)(null),g=(0,l.useRef)(null),p=n=>{if(e.disabled||0===n.length)return;let t=n[0];if(h(e.multiple?n:[t]),f.current){let a=new DataTransfer;if(e.multiple)for(let e of n)e&&a.items.add(e);else a.items.add(t);f.current.files=a.files}(n=>{var t,a;e.multiple?null==(t=e.onFiles)||t.call(e,n):n[0]&&(null==(a=e.onFile)||a.call(e,n[0]))})(n)},m=async()=>{var n;e.disabled||p([new File([await navigator.clipboard.readText()],null!=(n=e.pastedFilename)?n:"pasted.txt",{type:"text/plain"})])};return(0,a.jsx)("div",{ref:g,onDragEnter:n=>{n.preventDefault(),n.stopPropagation(),e.disabled||t(!0)},onDragOver:n=>{if(n.preventDefault(),n.stopPropagation(),e.disabled)return},onDragLeave:n=>{var a;n.preventDefault(),n.stopPropagation(),!e.disabled&&n.relatedTarget instanceof HTMLElement&&!(null==(a=g.current)?void 0:a.contains(n.relatedTarget))&&t(!1)},onDrop:n=>{if(n.preventDefault(),n.stopPropagation(),e.disabled)return;t(!1);let a=n.dataTransfer.files;a&&0!==a.length&&(e.multiple?p(Array.from(a)):p([a[0]]))},className:(0,d.$)("flex flex-col",n&&!e.disabled&&"bg-gray-100",e.disabled&&"opacity-50"),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("input",{type:"file",required:e.required,multiple:e.multiple,name:e.name,onChange:n=>{let t=n.target.files;t&&0!==t.length&&(e.multiple?p(Array.from(t)):p([t[0]]))},style:{display:"none"},ref:f,disabled:e.disabled}),(0,a.jsxs)("div",{className:(0,d.$)("border-2 border-dashed p-6 text-center transition-all duration-300",n?"border-blue-500 bg-blue-50 scale-105 shadow-lg":"border-gray-300"),children:[n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{className:"text-blue-500 mb-2",style:{fontSize:48}}),(0,a.jsxs)("p",{className:"text-blue-600 font-medium mb-2",children:["Release to select file",e.multiple?"s":""]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"mb-2",children:["Drag and drop file",e.multiple?"s":""," here"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"or"})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,a.jsxs)(i.default,{variant:"contained",onClick:()=>{var n;e.disabled||null==(n=f.current)||n.click()},startIcon:(0,a.jsx)(s.A,{}),disabled:e.disabled,children:["Select File",e.multiple?"s":""]}),(0,a.jsx)(i.default,{startIcon:(0,a.jsx)(o.A,{}),variant:"contained",onClick:m,disabled:e.disabled,children:"Paste"})]}),u.length>0&&(0,a.jsx)("ul",{className:"pt-4 space-y-1 text-left","aria-label":"Selected files",children:u.map((n,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"flex-1 break-all",children:n.name}),e.multiple&&(0,a.jsx)(i.default,{size:"small",variant:"outlined",color:"error","aria-label":"Remove ".concat(n.name),onClick:()=>{!e.disabled&&h(n=>{let a=n.filter((e,n)=>n!==t);if(f.current){let e=new DataTransfer;for(let n of a)e.items.add(n);f.current.files=e.files}if(e.multiple){var i;null==(i=e.onFiles)||i.call(e,a)}return a})},children:(0,a.jsx)(c.A,{fontSize:"small"})})]},"".concat(n.name,"-").concat(t)))})]})]})})}},42191:(e,n,t)=>{"use strict";t.d(n,{ConfigurationFileList:()=>eU});var a=t(95155),i=t(12115),l=t(50927),s=t(34880),r=t(70690),o=t(78065),c=t(86973),d=t(49501),u=t(17681),h=t(4474),f=t(2778),g=t(52363),p=t(65036),m=t(50001),x=t(25635),j=t(75912),y=t(86946),b=t(11665),v=t(52277),A=t(45291),C=t(545),w=t(61563),k=t(6490),S=t(20063),D=t(61023),N=t(22003),P=t(41602),F=t(23820),M=t(73707),z=t(59323),R=t(89134);let E=e=>{let{open:n,onClose:t,onTemplateSelected:l}=e,{data:o,isLoading:c,error:m}=(0,R.R9)(),[y,b]=(0,i.useState)(""),v=null==o?void 0:o.files,A=(0,i.useMemo)(()=>{let e=y.trim().toLowerCase();return e?(null!=v?v:[]).filter(n=>{let t=n.filename.toLowerCase(),a=(n.description||"").toLowerCase();return t.includes(e)||a.includes(e)}):null!=v?v:[]},[y,v]);return(0,a.jsxs)(f.A,{open:n,onClose:t,maxWidth:"md",fullWidth:!0,"aria-labelledby":"template-selection-title","aria-describedby":"template-selection-description",children:[(0,a.jsx)(g.A,{id:"template-selection-title",children:"Select Template"}),o&&o.files.length>0&&(0,a.jsx)(p.A,{className:"overflow-visible py-1",children:(0,a.jsx)(D.A,{value:y,onChange:e=>b(e.target.value),placeholder:"Search templates",fullWidth:!0,size:"small",margin:"normal",autoFocus:!0})}),(0,a.jsxs)(p.A,{id:"template-selection-description",className:"py-0",children:[c&&(0,a.jsx)(s.default,{className:"flex justify-center p-4",children:(0,a.jsx)(h.A,{})}),m&&(0,a.jsx)(N.A,{severity:"error",children:"Failed to load templates"}),o&&0===o.files.length&&(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",className:"text-center p-4",children:"No templates available"}),o&&o.files.length>0&&(0,a.jsx)(a.Fragment,{children:0===A.length?(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",className:"text-center p-4",children:"No matching templates"}):(0,a.jsx)(P.default,{children:A.map(e=>(0,a.jsx)(F.default,{disablePadding:!0,children:(0,a.jsxs)(M.default,{onClick:()=>{l(e)},className:"rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(z.A,{color:"primary"})}),(0,a.jsx)(u.default,{primary:e.filename,secondary:e.description||"No description available"})]})},e.filename))})})]}),(0,a.jsx)(j.A,{children:(0,a.jsx)(r.default,{onClick:t,variant:"outlined",children:"Cancel"})})]})};var T=t(47601);let W=e=>{let{open:n,onClose:t,template:l,currentDir:r}=e,[o,c]=(0,i.useState)(""),[d,u]=(0,i.useState)(""),h=(0,S.useRouter)();return((0,i.useEffect)(()=>{if(l){let e=l.filename,n=e.split("/").pop()||e;u(r||""),c(n.replace(/\.[^/.]+$/,"")+".radconf")}},[l,r]),l)?(0,a.jsxs)(f.A,{open:n,onClose:t,maxWidth:"md",fullWidth:!0,children:[(0,a.jsxs)(g.A,{children:["Create from Template: ",l.filename]}),(0,a.jsx)(p.A,{children:(0,a.jsxs)(s.default,{className:"flex flex-col gap-4 pt-2",children:[(0,a.jsx)(D.A,{label:"Filename",value:o,onChange:e=>c(e.target.value),placeholder:"my-config.radconf",helperText:"Enter a filename for the new configuration file",fullWidth:!0,required:!0}),(0,a.jsx)(T.B,{template:l,filename:d?"".concat(d,"/").concat(o):o,onSuccess:e=>{t();let n=null!=e?e:o,a=d&&!n.startsWith(d+"/")?"".concat(d,"/").concat(n):n;c(""),u(""),h.push("/configuration-file-details?filename=".concat(encodeURIComponent(a)))},onClose:t,mode:"create",className:"flex flex-col gap-4"})]})})]}):null};var I=t(78470),U=t(28548),O=t(21067),L=t(32683),q=t(99944),B=t(22822),$=t(18581),K=t(37045),Q=t(16061),_=t(18240),Y=t(51314),J=t(14915),V=t(36741),H=t(63358),G=t(71991),X=t(99776),Z=t(89489),ee=t(80549);let en=async e=>await e.get("configuration/pending/status").json(),et=()=>(0,Z.V8)(["configuration/pending/status"],en,{refetchInterval:5e3}),ea=async function(e,n){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={createBackup:t};n&&n.length&&(i.confirm=n),a&&(i.acknowledgeTestFailures=!0);let l=await e.post("configuration/pending/deploy",{json:i,throwHttpErrors:!1});return 409===l.status?{type:"conflicts",data:await l.json()}:{type:"success",data:await l.json()}},ei=async e=>await e.post("configuration/pending/discard").json(),el=async e=>await e.get("configuration/pending/backups").json(),es=async(e,n)=>await e.post("configuration/pending/restore",{json:{name:n}}).json(),er=async(e,n)=>await e.post("configuration/pending/restore-file",{json:{path:n}}).json(),eo=()=>{let e=(0,Z.JN)(!0),n=(0,X.jE)();return(0,ee.n)({mutationFn:n=>er(e,n),onSuccess:async()=>{await n.invalidateQueries({queryKey:["configuration/pending/status"]}),await n.invalidateQueries({queryKey:["configuration/dir"]}),await n.resetQueries({queryKey:["configuration/file"]})}})},ec=async(e,n)=>{let t=await e.get("configuration/pending/backups/".concat(encodeURIComponent(n),"/download"),{throwHttpErrors:!0});return await t.blob()};var ed=t(52619),eu=t.n(ed),eh=t(38661);let ef=e=>{let{open:n,onClose:t,backups:l,selectedBackup:o,onSelect:c,onRestore:d,isRestoring:u}=e,y=(()=>{let e=(0,Z.JN)(!0);return(0,ee.n)({mutationFn:n=>ec(e,n)})})(),b=(0,i.useCallback)(async()=>{let e;if(!o)return;try{e=await y.mutateAsync(o)}catch(e){return(0,G.M8)("Download failed: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"})}let n=URL.createObjectURL(e),t=document.createElement("a");t.href=n,t.download="".concat(o,".zip"),document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(n)},[y,o]);return(0,a.jsxs)(f.A,{open:n,onClose:t,maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:"Restore Configuration from Backup"}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(m.A,{children:"Select a backup to restore. The backup will be copied into the pending configuration. Restoring does not deploy the changes. You can review and edit the pending configuration, then deploy when ready."}),(0,a.jsx)(N.A,{severity:"warning",className:"mt-3",children:(0,a.jsx)(x.default,{variant:"body2",children:"Restoring copies the backup into the pending configuration and does not deploy automatically."})}),(0,a.jsx)(s.default,{className:"mt-3 space-y-2",children:0===l.length?(0,a.jsx)(N.A,{severity:"info",children:"No backups available."}):l.map(e=>(0,a.jsx)(r.default,{variant:o===e.name?"contained":"outlined",onClick:()=>c(e.name),fullWidth:!0,children:(0,a.jsxs)(s.default,{className:"flex justify-between w-full",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]})},e.name))})]}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{onClick:t,variant:"outlined",disabled:u||y.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{onClick:b,variant:"outlined",disabled:!o||y.isPending,startIcon:y.isPending?(0,a.jsx)(h.A,{size:16}):(0,a.jsx)(w.A,{fontSize:"small"}),children:y.isPending?"Downloading...":"Download"}),(0,a.jsx)(r.default,{onClick:d,variant:"contained",color:"secondary",disabled:!o||u||y.isPending,startIcon:u?(0,a.jsx)(h.A,{size:16}):null,children:u?"Restoring...":"Restore"})]})]})},eg=(e,n)=>e?(0,a.jsx)(h.A,{size:16}):n?(0,a.jsx)(n,{}):null,ep=e=>e?new Date(e).toLocaleString():"—",em=e=>{var n;let{className:t}=e,{data:o,isLoading:c}=et(),[d,u]=(0,i.useState)(!0),[y,b]=(0,i.useState)(!1),[v,A]=(0,i.useState)(!1),[C,w]=(0,i.useState)(!1),[k,S]=(0,i.useState)("syntax"),[D,M]=(0,i.useState)(null),[z,R]=(0,i.useState)(!1),[E,T]=(0,i.useState)(null),[W,en]=(0,i.useState)(!1),[er,ec]=(0,i.useState)(null),ed=(()=>{let e=(0,Z.JN)(!0),n=(0,X.jE)();return(0,ee.n)({mutationFn:n=>{var t,a;let i=null==n?void 0:n.confirm;return ea(e,i,null==(t=null==n?void 0:n.createBackup)||t,null!=(a=null==n?void 0:n.acknowledgeTestFailures)&&a)},onSuccess:async e=>{"success"===e.type&&(await n.invalidateQueries({queryKey:["configuration/pending/status"]}),await n.invalidateQueries({queryKey:["configuration/pending/backups"]}),await n.resetQueries({queryKey:["configuration/file"]}))}})})(),em=(0,X.jE)(),[ex,ej]=(0,i.useState)(null),[ey,eb]=(0,i.useState)(null),[ev,eA]=(0,i.useState)(null),[eC,ew]=(0,i.useState)(!1),[ek,eS]=(0,i.useState)(new Set),[eD,eN]=(0,i.useState)(!1),eP=(()=>{let e=(0,Z.JN)(!0),n=(0,X.jE)();return(0,ee.n)({mutationFn:()=>ei(e),onSuccess:async()=>{await n.invalidateQueries({queryKey:["configuration/pending/status"]}),await n.resetQueries({queryKey:["configuration/file"]})}})})(),eF=(0,l.KD)(),{data:eM}=(0,Z.V8)(["configuration/pending/backups"],el),ez=(()=>{let e=(0,Z.JN)(!0),n=(0,X.jE)();return(0,ee.n)({mutationFn:n=>es(e,n),onMutate:async()=>{n.setQueryData(["configuration/pending/status"],e=>({...null!=e?e:{hasPending:!1,createdAt:null,changedFiles:0,userConfigurationDirectory:"",changedFilesDetail:[]},hasPending:!0}))},onSuccess:async()=>{await n.invalidateQueries({queryKey:["configuration/pending/backups"]}),await n.invalidateQueries({queryKey:["configuration/pending/status"]}),await n.resetQueries({queryKey:["configuration/file"]})}})})(),eR=eo(),eE=null!=(n=null==eM?void 0:eM.backups)?n:[],eT=(0,i.useCallback)(async e=>{let n;S(e),M(null);try{n=await eF.mutateAsync({type:"configDir",dirPath:null,level:e})}catch(e){M([{file:null,line:null,message:"Configuration test failed",causes:[e instanceof Error?e.message:String(null!=e?e:"Unknown error")]}]);return}n.ok?((0,G.M8)("Configuration test (".concat(e,") passed successfully!"),{variant:"success"}),M(null)):M(n.errors)},[eF]),eW=(0,i.useCallback)(async()=>{try{await eP.mutateAsync()}catch(e){(0,G.M8)("Failed to discard pending configuration: ".concat(e instanceof Error?e.message:String(null!=e?e:"Unknown error")),{variant:"error"});return}await em.invalidateQueries({queryKey:["configuration/dir"]}),(0,G.M8)("Pending configuration discarded successfully!",{variant:"success"}),A(!1),w(!1)},[eP,em]),eI=(0,i.useCallback)(async()=>{let e;if(E){try{e=await ez.mutateAsync(E)}catch(e){(0,G.M8)("Failed to restore configuration: ".concat(e instanceof Error?e.message:String(null!=e?e:"Unknown error")),{variant:"error"});return}(0,G.M8)("Restored '".concat(e.restoredFrom,"' to pending configuration. Review and deploy to apply."),{variant:"success"}),R(!1),w(!1),T(null)}},[ez,E]);if(c)return null;let eU=!!(null==o?void 0:o.hasPending),eO=eE.length>0;if(!eU&&!eO)return null;let eL=(null==o?void 0:o.createdAt)?new Date(o.createdAt).toLocaleString():"Unknown",eq=((null==o?void 0:o.changedFilesDetail)||[]).map(e=>{if(!e)return null;let n=e.path||"",t=(e.changeType||"").toString().toLowerCase();return{path:n,changeType:"new"===t?"new":"deleted"===t?"deleted":"modified"}}).filter(Boolean);return eU?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{severity:"warning",className:t,action:(0,a.jsxs)(s.default,{className:"flex items-center gap-1",children:[!d&&(0,a.jsx)(I.A,{title:"Backup creation disabled for next deploy",children:(0,a.jsx)(K.A,{color:"warning",fontSize:"small"})}),(0,a.jsx)(r.default,{size:"small",variant:"outlined",color:"success",onClick:()=>w(!0),disabled:ed.isPending,startIcon:eg(ed.isPending,Q.A),children:"Review"}),eO&&(0,a.jsx)(r.default,{size:"small",variant:"outlined",color:"secondary",onClick:()=>R(!0),disabled:ez.isPending,startIcon:eg(ez.isPending,$.A),children:"Restore"})]}),children:(0,a.jsx)(s.default,{className:"flex items-center justify-between w-full",children:(0,a.jsxs)(s.default,{className:"flex items-center gap-2",children:[(0,a.jsxs)(x.default,{variant:"body2",children:[(0,a.jsx)("strong",{children:"Pending changes:"})," ",o.changedFiles," ",1===o.changedFiles?"file":"files"," changed"]}),(0,a.jsx)(U.A,{label:"Created ".concat(eL),size:"small",variant:"outlined"})]})})}),(0,a.jsxs)(f.A,{open:C,onClose:()=>w(!1),maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:(0,a.jsxs)(s.default,{className:"flex items-center gap-2",children:[(0,a.jsx)(K.A,{color:"warning"}),"Pending Configuration Changes"]})}),(0,a.jsx)(p.A,{children:(0,a.jsxs)(s.default,{className:"space-y-4",children:[(0,a.jsx)(N.A,{severity:"info",children:(0,a.jsxs)(x.default,{variant:"body2",children:["You have pending configuration changes that are not yet active.",(0,a.jsx)("br",{}),(0,a.jsx)("strong",{children:"Created:"})," ",eL,(0,a.jsx)("br",{}),(0,a.jsx)("strong",{children:"Changed files:"})," ",o.changedFiles," ",1===o.changedFiles?"file differs":"files differ"," ","from active configuration"]})}),(0,a.jsx)(O.default,{}),eq.length>0&&(0,a.jsxs)(s.default,{children:[(0,a.jsx)(x.default,{variant:"subtitle2",className:"mb-3",children:"Changed Files"}),(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",className:"mb-2",children:"Review individual file differences and optionally restore a file from the active configuration (or delete a newly added file)."}),(0,a.jsx)(P.default,{dense:!0,className:"max-h-60 overflow-auto mb-4",children:eq.map(e=>{let n="new"===e.changeType?"success":"deleted"===e.changeType?"error":"warning",t="new"===e.changeType?_.A:"deleted"===e.changeType?Y.A:J.A;return(0,a.jsxs)(F.default,{alignItems:"flex-start",disablePadding:!0,sx:{wordBreak:"break-all"},children:[(0,a.jsx)(t,{className:"mr-3",fontSize:"small",color:"success"===n?"success":"error"===n?"error":"warning"}),"deleted"===e.changeType?(0,a.jsx)("span",{className:"flex-1 opacity-50",children:e.path}):(0,a.jsx)(L.default,{component:eu(),className:"flex-1",color:"textPrimary",href:"/configuration-file-details?filename=".concat(encodeURIComponent(e.path)),children:e.path}),(0,a.jsx)(r.default,{size:"small",variant:"text",color:"secondary",disabled:eR.isPending,onClick:()=>{ec(e.path),en(!0)},children:"Restore"})]},e.path)})})]}),(0,a.jsxs)(s.default,{children:[(0,a.jsx)(x.default,{variant:"subtitle2",className:"mb-3",children:"Test Configuration"}),(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",className:"mb-3",children:"Validate your configuration syntax and settings before deployment."}),(0,a.jsx)(s.default,{className:"flex gap-2",children:[{level:"syntax",label:"Test Syntax"},{level:"full",label:"Test Full"}].map(e=>{let{level:n,label:t}=e;return(0,a.jsx)(r.default,{variant:"outlined",size:"small",onClick:()=>eT(n),disabled:eF.isPending,startIcon:eg(eF.isPending&&k===n,V.A),children:t},n)})}),(0,a.jsx)(eh.S,{errors:D,changedFilesDetail:eq,className:"mt-3"})]}),(0,a.jsx)(O.default,{}),(0,a.jsxs)(s.default,{children:[(0,a.jsx)(x.default,{variant:"subtitle2",className:"mb-3",children:"Actions"}),(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",className:"mb-3",children:"Deploy your changes to make them active, or discard them to start over."}),(0,a.jsxs)(s.default,{className:"flex gap-2",children:[(0,a.jsx)(r.default,{variant:"contained",color:"primary",disabled:ed.isPending,startIcon:eg(ed.isPending,H.A),onClick:()=>b(!0),children:"Deploy"}),eO&&(0,a.jsx)(r.default,{variant:"outlined",color:"secondary",onClick:()=>R(!0),disabled:ez.isPending,startIcon:eg(ez.isPending,$.A),children:"Restore from Backup"}),(0,a.jsx)(r.default,{variant:"outlined",color:"error",onClick:()=>A(!0),disabled:eP.isPending,startIcon:eg(eP.isPending,$.A),children:"Discard Changes"})]})]})]})}),(0,a.jsx)(j.A,{children:(0,a.jsx)(r.default,{onClick:()=>w(!1),variant:"outlined",children:"Close"})})]}),(0,a.jsxs)(f.A,{open:v,onClose:()=>A(!1),maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:"Discard Pending Changes"}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(m.A,{children:"Are you sure you want to discard all pending configuration changes? This will permanently delete all changes in the pending configuration."}),(0,a.jsx)(N.A,{severity:"error",className:"mt-2",children:(0,a.jsxs)(x.default,{variant:"body2",children:[(0,a.jsx)("strong",{children:"Warning:"})," This action cannot be undone. All pending changes will be lost."]})})]}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{onClick:()=>A(!1),variant:"outlined",disabled:eP.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{onClick:eW,variant:"contained",color:"error",disabled:eP.isPending,startIcon:eP.isPending?(0,a.jsx)(h.A,{size:16}):null,children:eP.isPending?"Discarding...":"Discard Changes"})]})]}),(0,a.jsxs)(f.A,{open:W,onClose:()=>{eR.isPending||(en(!1),ec(null))},maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:"Restore File"}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(m.A,{children:(()=>{let e=eq.find(e=>e.path===er);return e&&er?"new"===e.changeType?'The file "'.concat(er,'" is new in the pending configuration and does not exist in the active configuration. Restoring will delete it from pending (reverting the addition).'):"deleted"===e.changeType?'The file "'.concat(er,'" was deleted in pending. Restoring will recreate it from the active configuration.'):'The file "'.concat(er,'" was modified. Restoring will overwrite the pending version with the active configuration version.'):"Select a file to restore."})()}),(0,a.jsx)(N.A,{severity:"warning",className:"mt-3",children:(0,a.jsx)(x.default,{variant:"body2",children:"This action cannot be undone. You can still edit the file again afterwards if needed."})})]}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:()=>{eR.isPending||(en(!1),ec(null))},disabled:eR.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{variant:"contained",color:"secondary",disabled:!er||eR.isPending,onClick:async()=>{let e;if(er){try{e=await eR.mutateAsync(er)}catch(e){(0,G.M8)("Failed to restore file: ".concat(e instanceof Error?e.message:String(null!=e?e:"Unknown error")),{variant:"error"});return}(0,G.M8)(e.message,{variant:"success"}),en(!1),ec(null),await em.invalidateQueries({queryKey:["configuration/pending/status"]})}},startIcon:eR.isPending?(0,a.jsx)(h.A,{size:16}):null,children:eR.isPending?"Restoring...":"Restore"})]})]}),(0,a.jsxs)(f.A,{open:y&&!eD,onClose:()=>{ed.isPending||b(!1)},maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:"Deploy Configuration Changes"}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(m.A,{children:"Are you sure you want to deploy the pending configuration changes? This will:"}),(0,a.jsxs)(s.default,{component:"ul",className:"mt-2 mb-2",children:[(0,a.jsx)("li",{children:"Create a backup of the current active configuration"}),(0,a.jsx)("li",{children:"Replace the active configuration with pending changes"}),(0,a.jsx)("li",{children:"Clear the pending configuration"}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Restart the server"})," to apply the new configuration"]})]}),(0,a.jsx)(q.A,{control:(0,a.jsx)(B.A,{size:"small",checked:d,onChange:e=>u(e.target.checked)}),label:"Create backup before deploy"}),!d&&(0,a.jsx)(N.A,{severity:"warning",className:"mt-2",children:"A backup will NOT be created. You will be unable to restore to the current state automatically."}),(0,a.jsx)(N.A,{severity:"warning",className:"mt-3",children:(0,a.jsxs)(x.default,{variant:"body2",children:[(0,a.jsx)("strong",{children:"Warning:"})," This action will restart the server service. Active connections may be interrupted."]})})]}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{onClick:()=>b(!1),variant:"outlined",disabled:ed.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{onClick:async()=>{let e;try{e=await ed.mutateAsync({createBackup:d})}catch(e){(0,G.M8)("Failed to deploy configuration: ".concat(e instanceof Error?e.message:String(null!=e?e:"Unknown error")),{variant:"error"});return}"success"===e.type?((0,G.M8)("Configuration deployed successfully! ".concat(e.data.backupCreated?"Backup created: ".concat(e.data.backupCreated):""),{variant:"success"}),b(!1),w(!1),ej(null),await em.invalidateQueries({queryKey:["configuration/dir"]})):"conflicts"===e.type&&(b(!1),ej(e.data.conflicts),eb(e.data.testOk),eA(e.data.testErrors),eS(new Set(e.data.conflicts.map(e=>e.path))),ew(!1),eN(!0))},variant:"contained",color:"primary",disabled:ed.isPending,startIcon:ed.isPending?(0,a.jsx)(h.A,{size:16}):null,children:ed.isPending?"Deploying...":"Deploy"})]})]}),(0,a.jsx)(ef,{open:z,onClose:()=>R(!1),backups:eE,selectedBackup:E,onSelect:T,onRestore:eI,isRestoring:ez.isPending}),(0,a.jsxs)(f.A,{open:eD,onClose:()=>{ed.isPending||eN(!1)},maxWidth:"md",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:"Confirm conflicts"}),(0,a.jsx)(p.A,{children:ex&&ex.length>0||!1===ey?(0,a.jsxs)(s.default,{className:"space-y-3",children:[ev&&ev.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.default,{variant:"body2",className:"mb-2 font-semibold",children:"Full configuration test failed. You can still proceed, but deployment may cause runtime issues."}),(0,a.jsx)(eh.S,{errors:ev,changedFilesDetail:eq,className:"mt-3"})]}),!1===ey&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q.A,{control:(0,a.jsx)(B.A,{checked:eC,onChange:e=>ew(e.target.checked)}),label:"I understand the configuration test failed and want to deploy anyway"}),(0,a.jsx)(O.default,{})]}),ex&&ex.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{severity:"warning",children:(0,a.jsx)(x.default,{variant:"body2",children:"Files below changed in the active configuration since the pending snapshot. Confirm which ones to proceed with."})}),(0,a.jsxs)(s.default,{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)(r.default,{size:"small",variant:"outlined",onClick:()=>{ex&&0!==ex.length&&eS(new Set(ex.map(e=>e.path)))},disabled:ed.isPending||!ex||0===ex.length,children:"Select All"}),(0,a.jsx)(r.default,{size:"small",variant:"outlined",onClick:()=>eS(new Set),disabled:ed.isPending,children:"Clear All"})]}),(0,a.jsx)(s.default,{className:"max-h-96 overflow-auto border rounded",children:(null!=ex?ex:[]).slice().sort((e,n)=>e.action===n.action?e.path.localeCompare(n.path):"delete"===e.action?-1:1).map(e=>{let n=ek.has(e.path);return(0,a.jsxs)(s.default,{className:"flex items-start gap-3 px-3 py-2 border-b last:border-b-0 hover:bg-[rgba(0,0,0,0.03)] transition",children:[(0,a.jsx)("input",{type:"checkbox",className:"mt-1 cursor-pointer",checked:n,onChange:n=>{eS(t=>{let a=new Set(t);return n.target.checked?a.add(e.path):a.delete(e.path),a})}}),(0,a.jsxs)(s.default,{className:"flex-1 min-w-0",children:[(0,a.jsxs)(s.default,{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)(x.default,{variant:"body2",sx:{fontFamily:"monospace",wordBreak:"break-all"},children:e.path}),(0,a.jsx)(U.A,{size:"small",label:"delete"===e.action?"Delete":"Overwrite",color:"delete"===e.action?"error":"warning",variant:"filled"})]}),(0,a.jsx)(x.default,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic",display:"block"},children:e.message}),(0,a.jsxs)(s.default,{className:"grid",sx:{gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"4px",marginTop:"4px"},children:[(0,a.jsx)(I.A,{title:"File state when pending configuration was created",placement:"top",children:(0,a.jsxs)(x.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Baseline:"," ",ep(e.baselineModifiedAt)]})}),(0,a.jsx)(I.A,{title:"Current active file state",placement:"top",children:(0,a.jsxs)(x.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Current:"," ",null===e.currentSha256?"Missing (deleted)":ep(e.currentModifiedAt)]})}),e.pendingModifiedAt&&(0,a.jsx)(I.A,{title:"Timestamp of file in pending configuration",placement:"top",children:(0,a.jsxs)(x.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Pending:"," ",ep(e.pendingModifiedAt)]})})]})]})]},e.path)})})]})]}):(0,a.jsx)(N.A,{severity:"info",children:(0,a.jsx)(x.default,{variant:"body2",children:"No conflicts remain. You can close this dialog."})})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{onClick:()=>eN(!1),variant:"outlined",disabled:ed.isPending,children:"Close"}),(0,a.jsx)(r.default,{onClick:async()=>{let e;try{e=await ed.mutateAsync({confirm:Array.from(ek),createBackup:d,acknowledgeTestFailures:!1===ey&&eC})}catch(e){(0,G.M8)("Failed to deploy configuration: ".concat(e instanceof Error?e.message:String(null!=e?e:"Unknown error")),{variant:"error"});return}"success"===e.type?((0,G.M8)("Configuration deployed successfully! ".concat(e.data.backupCreated?"Backup created: ".concat(e.data.backupCreated):""),{variant:"success"}),eN(!1),w(!1),ej(null),await em.invalidateQueries({queryKey:["configuration/dir"]})):(ej(e.data.conflicts),eb(e.data.testOk),eA(e.data.testErrors),eS(new Set(e.data.conflicts.map(e=>e.path))),!1===e.data.testOk?ew(n=>n&&e.data.testErrors.length>0):ew(!1))},variant:"contained",color:"primary",disabled:ed.isPending||null===ex||ex.length>0&&0===ek.size||!1===ey&&!eC,startIcon:ed.isPending?(0,a.jsx)(h.A,{size:16}):null,children:ed.isPending?"Deploying...":"Confirm & Deploy"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{severity:"info",className:t,action:(0,a.jsx)(s.default,{className:"flex items-center gap-1",children:(0,a.jsx)(r.default,{size:"small",variant:"outlined",color:"secondary",onClick:()=>R(!0),disabled:ez.isPending,startIcon:eg(ez.isPending,$.A),children:"Restore from Backup"})}),children:(0,a.jsxs)(x.default,{variant:"body2",children:[(0,a.jsx)("strong",{children:"No pending changes."})," You can restore a previous backup."]})}),(0,a.jsx)(ef,{open:z,onClose:()=>R(!1),backups:eE,selectedBackup:E,onSelect:T,onRestore:eI,isRestoring:ez.isPending})]})};var ex=t(41983),ej=t(80007);let ey=(0,i.memo)(function(e){let{entry:n,currentDir:t,onOpenDir:l,onOpenMenu:r}=e,o=(0,i.useMemo)(()=>{let e=n.path.replace(/\/+$/,"");return t?"".concat(t,"/").concat(e):e},[n.path,t]),c=(0,i.useCallback)(()=>{l(o)},[l,o]);return(0,a.jsx)(F.default,{disablePadding:!0,children:(0,a.jsxs)(M.default,{onClick:c,className:"rounded-lg hover:bg-gray-50",sx:{pr:1,opacity:n.isDisabled?.5:1},"aria-label":"Open directory ".concat(n.path),children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(ej.A,{color:"primary"})}),(0,a.jsx)(u.default,{primary:(0,a.jsxs)(s.default,{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{children:n.path}),n.isDisabled&&(0,a.jsx)(U.A,{size:"small",label:"Disabled",color:"default",variant:"outlined"})]})}),"deleted"!==n.pendingChange&&(0,a.jsx)(ex.default,{onClick:e=>r(e,n.path,!0),size:"small","aria-label":"Directory actions ".concat(n.path),children:(0,a.jsx)(b.A,{})})]})})},(e,n)=>e.entry===n.entry&&e.currentDir===n.currentDir),eb=(0,i.memo)(function(e){let{entry:n,currentDir:t,onOpenFile:l,onOpenMenu:r}=e,o=(0,i.useMemo)(()=>t?"".concat(t,"/").concat(n.path):n.path,[t,n.path]),c="deleted"===n.pendingChange?"disabled":"changed"===n.pendingChange?"warning":"new"===n.pendingChange?"success":"primary",h=(0,i.useMemo)(()=>{if(!n.modifiedAt)return null;let e=new Date(n.modifiedAt).toLocaleDateString(),t="Size: ".concat(n.size," bytes").concat(n.createdAt?" • Created: ".concat(new Date(n.createdAt).toLocaleString()):"");return(0,a.jsx)(I.A,{title:t,children:(0,a.jsx)(U.A,{size:"small",label:e,variant:"outlined"})})},[n.modifiedAt,n.size,n.createdAt]),f=(0,i.useMemo)(()=>(0,a.jsxs)(a.Fragment,{children:["new"===n.pendingChange&&(0,a.jsx)(U.A,{size:"small",label:"New",color:"success",variant:"outlined"}),"changed"===n.pendingChange&&(0,a.jsx)(U.A,{size:"small",label:"Changed",color:"warning",variant:"outlined"}),"deleted"===n.pendingChange&&(0,a.jsx)(U.A,{size:"small",label:"Deleted",color:"error",variant:"outlined"}),n.isTemplateGenerated&&"deleted"!==n.pendingChange&&(0,a.jsx)(U.A,{size:"small",label:"Template generated",color:"secondary",variant:"outlined"}),n.isDisabled&&"deleted"!==n.pendingChange&&(0,a.jsx)(U.A,{size:"small",label:"Disabled",color:"default",variant:"outlined"}),h]}),[n.pendingChange,n.isTemplateGenerated,n.isDisabled,h]),g=(0,i.useCallback)(e=>{e.preventDefault(),"deleted"!==n.pendingChange&&l(o)},[n.pendingChange,l,o]);return(0,a.jsx)(F.default,{disablePadding:!0,sx:{opacity:"deleted"===n.pendingChange||n.isDisabled?.5:1},children:(0,a.jsxs)(M.default,{component:"deleted"===n.pendingChange?"div":eu(),href:"deleted"===n.pendingChange?void 0:"/configuration-file-details?filename=".concat(encodeURIComponent(o)),onClick:g,className:"rounded-lg hover:bg-gray-50",sx:{pr:1},"aria-label":"Open ".concat(n.path," configuration file"),children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(z.A,{color:c})}),(0,a.jsx)(u.default,{primary:(0,a.jsxs)(s.default,{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{children:n.path}),f]})}),(0,a.jsx)(ex.default,{onClick:e=>r(e,n.path,!1),size:"small","aria-label":"File actions ".concat(n.path),children:(0,a.jsx)(b.A,{})})]})})},(e,n)=>e.entry===n.entry&&e.currentDir===n.currentDir),ev=e=>{let{entries:n,currentDir:t,onOpenDir:i,onOpenFile:l,onOpenMenu:r,isLoading:o,error:c,className:d}=e;return o?(0,a.jsx)("div",{className:"flex justify-center p-4",children:(0,a.jsx)(h.A,{size:28})}):c?(0,a.jsx)(N.A,{severity:"error",children:"Failed to load configuration files"}):0===n.length?(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",className:"text-center p-4",children:"No configuration files found"}):(0,a.jsx)(s.default,{className:d,children:(0,a.jsx)(P.default,{className:"pb-0",children:n.map(e=>e.isDir?(0,a.jsx)(ey,{entry:e,currentDir:t,onOpenDir:i,onOpenMenu:r},"dir:".concat(e.path)):(0,a.jsx)(eb,{entry:e,currentDir:t,onOpenFile:l,onOpenMenu:r},"file:".concat(e.path)))})})};var eA=t(36944),eC=t(49692);let ew=(0,i.memo)(function(e){let{currentDir:n,onNavigate:t,className:l}=e,o=(0,i.useMemo)(()=>n.split("/").filter(Boolean).map((e,n,t)=>({label:e,path:t.slice(0,n+1).join("/"),isLast:n===t.length-1})),[n]),c=(0,i.useCallback)(()=>{""!==n&&t("")},[n,t]);return(0,a.jsxs)(s.default,{className:l,display:"flex",alignItems:"center",gap:1,children:[(0,a.jsx)(r.default,{size:"small",variant:""===n?"contained":"text",onClick:c,"aria-label":"Go to root directory",children:(0,a.jsx)(eA.A,{})}),o.map(e=>(0,a.jsxs)(s.default,{display:"flex",alignItems:"center",gap:.25,children:[(0,a.jsx)(eC.A,{fontSize:"small",className:"text-gray-500","aria-hidden":"true"}),(0,a.jsx)(r.default,{size:"small",variant:e.isLast?"contained":"text",className:"normal-case",onClick:()=>{e.isLast||t(e.path)},"aria-current":e.isLast?"page":void 0,children:e.label})]},e.path))]})});var ek=t(12857),eS=t(4484),eD=t(91473),eN=t(30836);let eP=(0,i.memo)(function(e){let{anchorEl:n,open:t,onClose:i,isDir:l=!1,showRestore:s,onDelete:r,onRename:h,onDuplicate:f,onRestore:g,hideStandardActions:p,showDisable:m,disabled:x,isDisabled:j,onToggleDisable:y}=e;return(0,a.jsxs)(o.A,{anchorEl:n,open:t,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[m&&y&&[(0,a.jsxs)(c.A,{onClick:()=>{x||y()},disabled:x,dense:!0,children:[(0,a.jsx)(d.A,{children:j?(0,a.jsx)(V.A,{fontSize:"small"}):(0,a.jsx)(ek.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:j?"Enable":"Disable"})]},"disable"),(0,a.jsx)(O.default,{},"divider")],!p&&[(0,a.jsxs)(c.A,{onClick:()=>{x||r()},disabled:x,dense:!0,children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(eS.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"Delete"})]},"delete"),(0,a.jsxs)(c.A,{onClick:()=>{x||h()},disabled:x,dense:!0,children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(eD.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"Rename"})]},"rename"),(0,a.jsxs)(c.A,{onClick:()=>{x||f()},disabled:x,dense:!0,children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(eN.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"Duplicate"})]},"duplicate")],!l&&s&&[!p&&(0,a.jsx)(O.default,{},"divider"),(0,a.jsxs)(c.A,{onClick:()=>{x||g()},disabled:x,dense:!0,children:[(0,a.jsx)(d.A,{children:(0,a.jsx)($.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"Restore"})]},"restore")]]})}),eF=e=>{let{open:n,currentDir:t,onClose:s,onCreated:o,existingEntries:c}=e,[d,u]=(0,i.useState)(""),[h,m]=(0,i.useState)(!1);(0,i.useEffect)(()=>{n&&(u(""),m(!1))},[n]);let x=(0,l.vz)({}),y=d.trim(),b=(0,i.useMemo)(()=>!!c&&!!y&&c.some(e=>!e.isDir&&!e.isDeleted&&e.path.replace(/\/$/,"")===y.replace(/\/$/,"")),[c,y]),v=y.includes("/"),A=0===y.length,C=h&&(A||v||b),w=h?A?"Filename is required":v?"Filename must not contain slashes":b?"A file with this name already exists":"Enter a filename for the new configuration file":"Enter a filename for the new configuration file",k=(0,i.useCallback)(async e=>{if(e&&e.preventDefault(),m(!0),C)return;let n=t?"".concat(t,"/").concat(y):y;try{await x.mutateAsync({fileName:n,data:""})}catch(n){let e="Failed to create configuration file: ".concat(n instanceof Error?n.message:String(n));(0,G.M8)(e,{variant:"error"});return}(0,G.M8)("Configuration file created successfully!",{variant:"success"}),null==o||o(n),s()},[t,y,x,C,s,o]);return(0,a.jsxs)(f.A,{open:n,onClose:()=>{x.isPending||s()},maxWidth:"sm",fullWidth:!0,slotProps:{paper:{component:"form",onSubmit:k}},children:[(0,a.jsx)(g.A,{children:"Create New Configuration File"}),(0,a.jsx)(p.A,{children:(0,a.jsx)(D.A,{margin:"dense",id:"create-config-filename",label:"Filename",type:"text",fullWidth:!0,variant:"outlined",value:d,onChange:e=>u(e.target.value),onBlur:()=>m(!0),placeholder:"e.g. my-config.radconf",error:C,helperText:w,disabled:x.isPending})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{onClick:s,variant:"outlined",disabled:x.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{type:"submit",variant:"contained",disabled:x.isPending||C||A,children:x.isPending?"Creating...":"Create"})]})]})};function eM(e){let{open:n,onClose:t,currentDir:s,onCreated:o,existingEntries:c}=e,[d,u]=(0,i.useState)(""),[h,m]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!1);(0,i.useEffect)(()=>{n&&(u(""),m(!1),b(!1))},[n]);let v=(0,i.useMemo)(()=>(function(e,n){let t=e.trim();return 0===t.length?{error:!0,helper:"Directory name is required"}:t.startsWith(".")?{error:!0,helper:"Name must not start with a dot"}:t.includes("/")?{error:!0,helper:"Name must not contain slashes"}:t.includes("..")?{error:!0,helper:"Name must not contain '..'"}:(null==n?void 0:n.some(e=>e.path.replace(/\/$/,"")===t&&!e.isDeleted))?{error:!0,helper:"An entry with this name already exists"}:{error:!1,helper:"Enter a directory name (no slashes, not starting with dot)"}})(d,c),[d,c]),A=(0,l.RS)({onSuccess:()=>{(0,G.M8)("Directory created successfully!",{variant:"success"})}}),C=(0,i.useMemo)(()=>d.trim()?s?"".concat(s,"/").concat(d.trim()):d.trim():"",[d,s]),w=(0,i.useCallback)(async e=>{if(e&&e.preventDefault(),m(!0),!v.error&&C){try{await A.mutateAsync(C)}catch(e){(0,G.M8)("Failed to create directory: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}null==o||o(C),t()}},[v.error,C,A,o,t]);return(0,a.jsxs)(f.A,{open:n,onClose:()=>{A.isPending||t()},maxWidth:"sm",fullWidth:!0,slotProps:{paper:{component:"form",onSubmit:w}},children:[(0,a.jsx)(g.A,{children:"Create New Directory"}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(D.A,{margin:"dense",id:"create-config-directory-name",label:"Directory Name",type:"text",fullWidth:!0,variant:"outlined",value:d,onChange:e=>u(e.target.value),onBlur:()=>m(!0),placeholder:"e.g. subdir",error:h&&v.error,helperText:v.helper,disabled:A.isPending,autoFocus:!0}),(0,a.jsx)(q.A,{control:(0,a.jsx)(B.A,{checked:y,onChange:e=>b(e.target.checked),disabled:!0}),label:(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",children:"Force (reserved)"})})]}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{onClick:t,variant:"outlined",disabled:A.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{type:"submit",variant:"contained",disabled:A.isPending||v.error||!d.trim(),children:A.isPending?"Creating...":"Create"})]})]})}let ez=e=>{let{open:n,fromPath:t,isDir:s,onClose:o,onRenamed:c,existingSiblingEntries:d}=e,[u,h]=(0,i.useState)(""),[m,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{n&&t&&(h((t.split("/").pop()||t).replace(/\/+$/,"")),x(!1)),n||(h(""),x(!1))},[n,t]);let y=(0,l.qn)(),b=(0,l.V5)(),v=(0,i.useMemo)(()=>t&&t.includes("/")?t.split("/").slice(0,-1).join("/"):"",[t]),A=u.trim(),C=(0,i.useMemo)(()=>!!d&&!!A&&d.some(e=>!e.isDeleted&&e.path.replace(/\/+$/,"")===A),[d,A]),w=0===A.length||A.includes("/")||A.startsWith(".")||A.includes("..")||C,k=(0,i.useMemo)(()=>m?0===A.length?"Name is required":A.includes("/")?"Name must not contain slashes":A.startsWith(".")?"Name must not start with a dot":A.includes("..")?"Name must not contain '..'":C?"An entry with this name already exists":"Name only (no slashes)":"Name only (no slashes)",[m,A,C]),S=(0,i.useMemo)(()=>t&&A?v?"".concat(v,"/").concat(A):A:null,[t,v,A]),N=y.isPending||b.isPending||!1,P=S===t,F=!!S&&!w&&!P&&!N,M=(0,i.useCallback)(async e=>{if(e&&e.preventDefault(),x(!0),F&&t&&null!=S){try{s?await b.mutateAsync({from:t,to:S}):await y.mutateAsync({from:t,to:S})}catch(e){(0,G.M8)("Failed to rename: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}(0,G.M8)("Renamed successfully",{variant:"success"}),null==c||c(t,S),o()}},[F,t,S,s,b,y,c,o]);return(0,a.jsxs)(f.A,{open:n,onClose:()=>{N||o()},maxWidth:"xs",fullWidth:!0,slotProps:{paper:{component:"form",onSubmit:M}},children:[(0,a.jsx)(g.A,{children:s?"Rename Directory":"Rename File"}),(0,a.jsx)(p.A,{children:(0,a.jsx)(D.A,{margin:"dense",label:"New Name",fullWidth:!0,value:u,onChange:e=>h(e.target.value),onBlur:()=>x(!0),helperText:k,error:m&&w,disabled:N||!t})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:o,disabled:N,children:"Cancel"}),(0,a.jsx)(r.default,{type:"submit",variant:"contained",disabled:!F,children:N?"Renaming...":"Rename"})]})]})};function eR(e){let{open:n,sourcePath:t,isDir:s,existingSiblingEntries:o,onClose:c,onDuplicated:d}=e,[u,h]=(0,i.useState)(""),[m,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{n&&t&&(h(function(e,n){let t=e=>e.replace(/\/+$/,""),a=new Set((n||[]).filter(e=>!e.isDeleted).map(e=>t(e.path))),i=t(e),l="".concat(i,"-copy");if(!a.has(l))return l;let s=2;for(;a.has("".concat(i,"-copy-").concat(s))&&s<1e3;)s+=1;return"".concat(i,"-copy-").concat(s)}(t.split("/").pop()||t,o)),x(!1)),n||(h(""),x(!1))},[n,t,o]);let y=(0,l.v0)(),b=(0,l.aA)(),v=(0,i.useMemo)(()=>t&&t.includes("/")?t.split("/").slice(0,-1).join("/"):"",[t]),A=u.trim(),C=(0,i.useMemo)(()=>!!o&&!!A&&o.some(e=>!e.isDeleted&&e.path.replace(/\/+$/,"")===A),[o,A]),w=0===A.length||A.includes("/")||A.startsWith(".")||A.includes("..")||C,k=(0,i.useMemo)(()=>m?0===A.length?"Name is required":A.includes("/")?"Name must not contain slashes":A.startsWith(".")?"Name must not start with a dot":A.includes("..")?"Name must not contain '..'":C?"An entry with this name already exists":"Name only (no slashes)":"Name only (no slashes)",[m,A,C]),S=(0,i.useMemo)(()=>t&&A?v?"".concat(v,"/").concat(A):A:null,[t,v,A]),N=y.isPending||b.isPending,P=S===t,F=!!S&&!w&&!P&&!N&&!!t,M=(0,i.useCallback)(async e=>{if(e&&e.preventDefault(),x(!0),F&&t&&S){try{s?await b.mutateAsync({source:t,destination:S}):await y.mutateAsync({source:t,destination:S})}catch(e){(0,G.M8)("Failed to duplicate: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}(0,G.M8)("Duplicated successfully",{variant:"success"}),null==d||d(t,S),c()}},[F,t,S,s,b,y,d,c]);return(0,a.jsxs)(f.A,{open:n,onClose:()=>{N||c()},maxWidth:"xs",fullWidth:!0,slotProps:{paper:{component:"form",onSubmit:M}},children:[(0,a.jsx)(g.A,{children:s?"Duplicate Directory":"Duplicate File"}),(0,a.jsx)(p.A,{children:(0,a.jsx)(D.A,{autoFocus:!0,margin:"dense",label:"Destination Name",fullWidth:!0,value:u,onChange:e=>h(e.target.value),onBlur:()=>x(!0),helperText:"".concat(k,". A new copy will be created."),error:m&&w,disabled:N||!t})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:c,disabled:N,children:"Cancel"}),(0,a.jsx)(r.default,{type:"submit",variant:"contained",disabled:!F,children:N?"Duplicating...":"Duplicate"})]})]})}function eE(e){let{open:n,filePath:t,onClose:s,onDeleted:o}=e,c=(0,l.ie)(),d=(0,i.useCallback)(async()=>{if(t){try{await c.mutateAsync(t)}catch(e){(0,G.M8)("Failed to delete configuration file: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}(0,G.M8)("Configuration file deleted successfully!",{variant:"success"}),null==o||o(t),s()}},[c,t,s,o]),u=c.isPending,h=!t||u;return(0,a.jsxs)(f.A,{open:n,onClose:()=>{u||s()},maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-config-file-title",children:[(0,a.jsx)(g.A,{id:"delete-config-file-title",children:"Delete Configuration File"}),(0,a.jsx)(p.A,{children:(0,a.jsx)(m.A,{children:t?'Are you sure you want to delete "'.concat(t,'"? This action cannot be undone.'):"Are you sure you want to delete this file?"})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:s,disabled:u,children:"Cancel"}),(0,a.jsx)(r.default,{variant:"contained",color:"error",onClick:d,disabled:h,children:u?"Deleting...":"Delete"})]})]})}function eT(e){let{open:n,dirPath:t,onClose:o,onDeleted:c,allowForce:d=!0,initialForce:u=!1}=e,[h,y]=(0,i.useState)(u);(0,i.useEffect)(()=>{n&&y(u)},[n,u]);let b=(0,l.a7)({onSuccess:()=>{(0,G.M8)("Directory deleted successfully!",{variant:"success"})}}),v=b.isPending,A=!t||v,C=(0,i.useCallback)(async()=>{if(t){try{await b.mutateAsync({path:t,force:h})}catch(e){(0,G.M8)("Failed to delete directory: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}null==c||c(t,h),o()}},[t,h,b,c,o]);return(0,a.jsxs)(f.A,{open:n,onClose:()=>{v||o()},maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-config-directory-title",children:[(0,a.jsx)(g.A,{id:"delete-config-directory-title",children:"Delete Directory"}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(m.A,{children:t?'Are you sure you want to delete the directory "'.concat(t,'"? This action cannot be undone.'):"Are you sure you want to delete this directory? This action cannot be undone."}),d&&(0,a.jsxs)(s.default,{mt:1,children:[(0,a.jsx)(q.A,{control:(0,a.jsx)(B.A,{checked:h,onChange:e=>y(e.target.checked),disabled:v}),label:"Force delete recursively (delete even if not empty)"}),(0,a.jsx)(x.default,{variant:"caption",color:"text.secondary",display:"block",ml:4.5,children:"Force delete will remove all files and subdirectories inside this directory."})]})]}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:o,disabled:v,children:"Cancel"}),(0,a.jsx)(r.default,{variant:"contained",color:"error",onClick:C,disabled:A,children:v?"Deleting...":h?"Force Delete":"Delete"})]})]})}var eW=t(23778);function eI(e){let{open:n,onClose:t,currentDir:o,onUploaded:c,existingEntries:d}=e,[u,h]=(0,i.useState)([]),[m,y]=(0,i.useState)(""),[b,v]=(0,i.useState)(!1),[A,w]=(0,i.useState)(!1),k=(0,l.vz)({}),S=i.useRef(n);n&&!S.current&&(h([]),y(""),v(!1),w(!1)),S.current=n;let N=u.length<=1,P=N?u[0]:null,F=N?m.trim():"",M=(0,i.useMemo)(()=>!!N&&!!d&&!!F&&d.some(e=>!e.isDir&&!e.isDeleted&&e.path.replace(/\/$/,"")===F.replace(/\/$/,"")),[d,F,N]),z=N&&0===F.length,R=N&&F.includes("/"),E=N&&(z||R||M),T="Destination filename (no slashes)";N?(b||(T="Destination filename (no slashes)"),z&&(T="Filename is required"),R&&(T="Filename must not contain slashes"),M&&(T="A file with this name already exists")):T="Multiple files selected (original names will be used)";let W=(0,i.useMemo)(()=>!d||N?[]:u.filter(e=>d.some(n=>!n.isDir&&!n.isDeleted&&n.path.replace(/\/$/,"")===e.name)).map(e=>e.name),[d,u,N]),I=(0,i.useMemo)(()=>{if(N)return[];let e=new Set,n=new Set;for(let t of u)e.has(t.name)?n.add(t.name):e.add(t.name);return Array.from(n.values())},[u,N]),U=0===u.length,O=(0,i.useMemo)(()=>N&&F?o?"".concat(o,"/").concat(F):F:null,[F,o,N]),L=!N&&(W.length>0||I.length>0),q=!k.isPending&&!U&&(N?!E:!L),B=(0,i.useCallback)(async e=>{var n;let a;if(e&&e.preventDefault(),v(!0),w(!0),!q)return;let i=N&&P&&O?[{fileName:O,data:P}]:u.map(e=>({fileName:o?"".concat(o,"/").concat(e.name):e.name,data:e}));if(!i.length)return;try{a=await k.mutateAsync(i)}catch(e){(0,G.M8)("Failed to upload configuration file(s): ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}let l=null!=(n=a.results)?n:[],s=l.filter(e=>e.success).length,r=l.length-s;s&&!r?(0,G.M8)("".concat(s," file").concat(1!==s?"s":""," uploaded successfully."),{variant:"success"}):s&&r?(0,G.M8)("".concat(s," uploaded, ").concat(r," failed."),{variant:"warning"}):r&&(0,G.M8)("".concat(r," file").concat(1!==r?"s":""," failed to upload."),{variant:"error"}),N&&1===s&&O&&(null==c||c(O)),t()},[q,P,O,c,t,N,u,o,k]);return(0,a.jsxs)(f.A,{open:n,onClose:()=>{k.isPending||t()},maxWidth:"sm",fullWidth:!0,slotProps:{paper:{component:"form",onSubmit:B}},children:[(0,a.jsx)(g.A,{children:"Upload Configuration File"}),(0,a.jsx)(p.A,{children:(0,a.jsxs)(s.default,{display:"flex",flexDirection:"column",gap:2,mt:.5,children:[N&&(0,a.jsx)(D.A,{margin:"dense",label:"Destination Filename",value:m,onChange:e=>y(e.target.value),onBlur:()=>v(!0),error:b&&E,helperText:T,fullWidth:!0,disabled:k.isPending,placeholder:"e.g. custom-auth.radconf",autoFocus:!0}),!N&&(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",sx:{mt:1},children:T}),(0,a.jsx)(eW.S,{name:"upload-config-file",multiple:!0,onFile:e=>{h([e]),w(!0),m||y(e.name)},onFiles:e=>{h(e),w(!0),1!==e.length||m||y(e[0].name)},disabled:k.isPending,pastedFilename:"pasted-config.radconf"}),A&&U&&(0,a.jsx)(x.default,{variant:"body2",color:"error",sx:{mt:-1},children:N?"A file must be selected":"At least one file must be selected"}),!N&&W.length>0&&(0,a.jsxs)(x.default,{variant:"body2",color:"error",sx:{mt:-1},children:["Conflicts with existing: ",W.join(", ")]}),!N&&I.length>0&&(0,a.jsxs)(x.default,{variant:"body2",color:"error",sx:{mt:-1},children:["Duplicate names in selection: ",I.join(", ")]}),!N&&u.length>1&&(0,a.jsxs)(x.default,{variant:"caption",color:"text.secondary",sx:{mt:-1},children:[u.length," files selected"]}),(0,a.jsx)(x.default,{variant:"body2",color:"text.secondary",children:N?"The file will be added to the pending configuration. It will not take effect until the pending configuration is applied.":"The files will be added to the pending configuration. They do not take effect until the pending configuration is applied."})]})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:t,disabled:k.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{type:"submit",variant:"contained",disabled:!q,startIcon:(0,a.jsx)(C.A,{}),children:k.isPending?"Uploading...":N?"Upload":"Upload Files"})]})]})}let eU=()=>{var e,n;let t=(0,S.useSearchParams)(),D=t.get("dir")||"",[N,P]=(0,i.useState)(D),{data:F,isLoading:M,error:z}=(0,l.hY)(N),R=(0,i.useMemo)(()=>{var e;return null!=(e=null==F?void 0:F.entries)?e:[]},[null==F?void 0:F.entries]),[T,I]=(0,i.useState)(null),[U,O]=(0,i.useState)(null),[L,q]=(0,i.useState)(!1),[B,$]=(0,i.useState)(!1),[K,Q]=(0,i.useState)(!1),[_,Y]=(0,i.useState)(!1),[J,V]=(0,i.useState)(!1),[H,X]=(0,i.useState)(!1),[ee,en]=(0,i.useState)(!1),[ea,ei]=(0,i.useState)(!1),[el,es]=(0,i.useState)(!1),[er,ec]=(0,i.useState)(null),[ed,eu]=(0,i.useState)(null),[eh,ef]=(0,i.useState)(!1),[eg,ep]=(0,i.useState)(null),ex=eo(),[ej,ey]=(0,i.useState)(null),[eb,eA]=(0,i.useState)(!1),eC=(0,Z.JN)(!0),ek=(0,l.lL)({onSuccess:()=>{(0,G.M8)("Configuration imported into pending directory",{variant:"success"})}}),{data:eS}=et(),eD=(0,i.useRef)(null),eN=(0,i.useCallback)(e=>ey(e.currentTarget),[]),eW=(0,i.useCallback)(()=>ey(null),[]),eU=(0,i.useCallback)(async()=>{if(eb)return;eA(!0);let e=null;try{e=await eC.get("configuration/export",{throwHttpErrors:!0})}catch(e){return(0,G.M8)("Export failed: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"}),eA(!1),eW(),null}if(!e)return;let n=null;try{n=await e.blob()}catch(e){return(0,G.M8)("Export failed: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"}),eA(!1),eW(),null}if(!n)return;let t="configuration-export.zip",a=e.headers.get("content-disposition");if(a){let e=/filename\*?=([^;]+)/i.exec(a);if(e&&e[1]){let n=e[1].trim();(n=(n=n.replace(/^UTF-8''/i,"")).replace(/^"+|"+$/g,""))&&(t=n)}}let i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=t,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(i),(0,G.M8)("Export ready: ".concat(t),{variant:"success"}),eA(!1),eW()},[eb,eC,eW]),eO=(0,i.useCallback)(()=>{var e;null==(e=eD.current)||e.click()},[]),eL=(0,i.useCallback)(async e=>{var n;let t=null==(n=e.target.files)?void 0:n[0];if(!t)return;let a=!1;if(null==eS?void 0:eS.hasPending){if(!window.confirm("A pending configuration already exists. Overwrite it with the imported archive?")){e.target.value="";return}a=!0}try{await ek.mutateAsync({file:t,overwrite:a})}catch(e){(0,G.M8)("Import failed: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"})}finally{e.target.value="",eW()}},[ek,eS,eW]),eq=(0,S.useRouter)();(0,i.useEffect)(()=>{let e=t.get("dir")||"";e!==N&&P(e)},[t,N]);let eB=(0,i.useCallback)(e=>{let n=new URLSearchParams;e&&n.set("dir",e),eq.push(n.toString()?"/configuration-files?".concat(n.toString()):"/configuration-files"),P(e)},[eq]),e$=(0,i.useCallback)((e,n,t)=>{e.preventDefault(),e.stopPropagation();let a=n;!N||n.startsWith(N)||n.includes("/")&&n.split("/")[0]===N.split("/")[0]||(a=N?"".concat(N,"/").concat(n.replace(/\/+$/,"")):n),I({path:a.replace(/\/+$/,""),isDir:t}),O(e.currentTarget)},[N]),eK=(0,i.useCallback)(()=>{O(null)},[]),eQ=(0,i.useCallback)(()=>{T&&(Q(!0),eK())},[T,eK]),e_=(0,i.useCallback)(()=>{T&&(Y(!0),eK())},[T,eK]),eY=(0,i.useCallback)(()=>{T&&(T.isDir?X(!0):V(!0),eK())},[T,eK]),eJ=(0,i.useCallback)(()=>{T&&!T.isDir&&(ep(T.path),ef(!0),eK())},[T,eK]),eV=(0,i.useCallback)(e=>{eu(e.currentTarget)},[]),eH=(0,i.useCallback)(()=>{eu(null)},[]),eG=(0,i.useCallback)(()=>{ei(!0)},[]),eX=(0,i.useCallback)(e=>{ec(e),ei(!1),es(!0)},[]),eZ=(0,i.useCallback)(()=>{es(!1),ec(null)},[]),e0=(0,i.useMemo)(()=>R.map(e=>({path:e.path,isDir:e.isDir,isDeleted:"deleted"===e.pendingChange})),[R]),e1=(0,i.useCallback)(e=>{eq.push("/configuration-file-details?filename=".concat(encodeURIComponent(e)))},[eq]),e2=(0,i.useCallback)(e=>{e===N&&eB(N.includes("/")?N.split("/").slice(0,-1).join("/"):"")},[N,eB]),e8=null!=(e=null==T?void 0:T.isDir)?e:null,e5=null!=(n=null==T?void 0:T.path)?n:null,e4=(0,i.useMemo)(()=>e5?R.find(e=>{let n=e.path.endsWith("/")?e.path.slice(0,-1):e.path;return(N?"".concat(N,"/").concat(n):n)===e5}):null,[e5,R,N]),e3=!!e4&&("changed"===e4.pendingChange||"deleted"===e4.pendingChange),e6=!!e4&&"deleted"!==e4.pendingChange,e7=(null==e4?void 0:e4.pendingChange)==="deleted"&&!e8,e9=(0,l.qn)(),ne=(0,l.V5)(),nn=(0,i.useCallback)(()=>{let e;if(!e4||!e5)return;let n=e5.split("/").pop()||"",t=e5.includes("/")?e5.split("/").slice(0,-1).join("/"):"",a=e4.isDisabled;if(a){if(!(e=n.replace(/^_+/,"")))return void(0,G.M8)("Cannot enable entry: resulting name would be empty.",{variant:"error"})}else{if(n.startsWith("_"))return void(0,G.M8)("Entry already disabled.",{variant:"info"});e="_".concat(n)}let i=t?"".concat(t,"/").concat(e):e,l=()=>{(0,G.M8)("".concat(e4.isDir?"Directory":"File"," ").concat(a?"enabled":"disabled"," successfully."),{variant:"success"})},s=e=>{(0,G.M8)("Failed to ".concat(a?"enable":"disable"," ").concat(e4.isDir?"directory":"file",": ").concat(String(e)),{variant:"error"})};e4.isDir?ne.mutate({from:e5,to:i},{onSuccess:l,onError:s}):e9.mutate({from:e5,to:i},{onSuccess:l,onError:s}),eK()},[e4,e5,e9,ne,eK]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(em,{className:"mb-4"}),(0,a.jsxs)(s.default,{display:"flex",flexDirection:"column",gap:2,children:[(0,a.jsxs)(s.default,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,a.jsx)(ew,{currentDir:N,onNavigate:e=>eB(e)}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(r.default,{size:"small",variant:"outlined",startIcon:(0,a.jsx)(y.A,{}),onClick:eV,"aria-controls":ed?"create-config-menu":void 0,"aria-haspopup":"true","aria-expanded":ed?"true":void 0,children:"Create"}),(0,a.jsx)(r.default,{size:"small",variant:"outlined",className:"ml-2",onClick:eN,"aria-controls":ej?"config-actions-menu":void 0,"aria-haspopup":"true","aria-expanded":ej?"true":void 0,title:"More actions",children:(0,a.jsx)(b.A,{fontSize:"small"})}),(0,a.jsxs)(o.A,{id:"create-config-menu",anchorEl:ed,open:!!ed,onClose:eH,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[(0,a.jsxs)(c.A,{onClick:()=>{eH(),eG()},children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(v.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"Configuration from template"})]}),(0,a.jsxs)(c.A,{onClick:()=>{eH(),q(!0)},children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(y.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"New configuration file"})]}),(0,a.jsxs)(c.A,{onClick:()=>{eH(),$(!0)},children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(A.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"New directory"})]}),(0,a.jsxs)(c.A,{onClick:()=>{eH(),en(!0)},children:[(0,a.jsx)(d.A,{children:(0,a.jsx)(C.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:"Upload file"})]})]}),(0,a.jsxs)(o.A,{id:"config-actions-menu",anchorEl:ej,open:!!ej,onClose:eW,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[(0,a.jsxs)(c.A,{onClick:eU,disabled:eb,children:[(0,a.jsx)(d.A,{children:eb?(0,a.jsx)(h.A,{size:16}):(0,a.jsx)(w.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:eb?"Exporting...":"Export (.zip)"})]}),(0,a.jsxs)(c.A,{onClick:eO,disabled:ek.isPending,children:[(0,a.jsx)(d.A,{children:ek.isPending?(0,a.jsx)(h.A,{size:16}):(0,a.jsx)(k.A,{fontSize:"small"})}),(0,a.jsx)(u.default,{primary:ek.isPending?"Importing...":"Import (.zip)"})]})]}),(0,a.jsx)("input",{ref:eD,type:"file",accept:".zip,application/zip",onChange:eL,style:{display:"none"}})]})]}),(0,a.jsx)(ev,{entries:R,currentDir:N,onOpenDir:e=>eB(e),onOpenFile:e=>eq.push("/configuration-file-details?filename=".concat(encodeURIComponent(e))),onOpenMenu:e$,isLoading:M,error:z})]}),(0,a.jsx)(eP,{anchorEl:U,open:!!U,onClose:eK,isDir:e8,onDelete:eY,onRename:eQ,onDuplicate:e_,onRestore:eJ,showRestore:e3,hideStandardActions:e7,showDisable:e6,isDisabled:null==e4?void 0:e4.isDisabled,onToggleDisable:nn,disabled:e9.isPending||ne.isPending}),(0,a.jsx)(eF,{open:L,onClose:()=>q(!1),currentDir:N,onCreated:e1,existingEntries:e0}),(0,a.jsx)(eM,{open:B,onClose:()=>$(!1),currentDir:N,onCreated:()=>{(0,G.M8)("Directory created successfully!",{variant:"success"})},existingEntries:e0}),(0,a.jsx)(eI,{open:ee,onClose:()=>en(!1),currentDir:N,onUploaded:e1,existingEntries:e0}),(0,a.jsx)(ez,{open:K,fromPath:e5,isDir:e8,onClose:()=>Q(!1),existingSiblingEntries:e0,onRenamed:()=>Q(!1)}),(0,a.jsx)(eR,{open:_,sourcePath:e5,isDir:e8,onClose:()=>Y(!1),existingSiblingEntries:e0,onDuplicated:()=>Y(!1)}),(0,a.jsx)(eE,{open:J,filePath:e8?null:e5,onClose:()=>V(!1),onDeleted:()=>V(!1)}),(0,a.jsx)(eT,{open:H,dirPath:e8?e5:null,onClose:()=>X(!1),onDeleted:e=>{X(!1),e2(e)}}),(0,a.jsx)(E,{open:ea,onClose:()=>ei(!1),onTemplateSelected:eX}),(0,a.jsx)(W,{open:el,onClose:eZ,template:er,currentDir:N}),(0,a.jsxs)(f.A,{open:eh,onClose:()=>{ex.isPending||(ef(!1),ep(null))},maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(g.A,{children:"Restore File"}),(0,a.jsx)(p.A,{dividers:!0,children:(0,a.jsx)(m.A,{component:"div",children:eg&&(0,a.jsx)(x.default,{variant:"body2",children:(()=>{let e=R.find(e=>(N?"".concat(N,"/").concat(e.path):e.path)===eg);return e?"new"===e.pendingChange?'The file "'.concat(eg,'" is new in the pending configuration. Restoring will delete it (reverting the addition).'):"deleted"===e.pendingChange?'The file "'.concat(eg,'" was deleted in the pending configuration. Restoring will recreate it from the active configuration.'):"changed"===e.pendingChange?'The file "'.concat(eg,'" was modified. Restoring will overwrite the pending version with the active configuration version.'):'The file "'.concat(eg,'" has no pending changes.'):'Restore pending changes for "'.concat(eg,'".')})()})})}),(0,a.jsxs)(j.A,{children:[(0,a.jsx)(r.default,{variant:"outlined",onClick:()=>{ex.isPending||(ef(!1),ep(null))},disabled:ex.isPending,children:"Cancel"}),(0,a.jsx)(r.default,{variant:"contained",color:"secondary",disabled:!eg||ex.isPending,onClick:async()=>{let e;if(eg){try{e=await ex.mutateAsync(eg)}catch(e){(0,G.M8)("Failed to restore file: ".concat(e instanceof Error?e.message:String(e)),{variant:"error"});return}(0,G.M8)(e.message,{variant:"success"}),ef(!1),ep(null)}},startIcon:ex.isPending?(0,a.jsx)(h.A,{size:16}):null,children:ex.isPending?"Restoring...":"Restore"})]})]})]})}}},e=>{e.O(0,[7972,9140,4854,5070,8548,870,2378,4614,7097,2619,3820,3202,5367,4180,449,1023,4488,5154,2677,242,8845,8441,1255,7358],()=>e(e.s=5333)),_N_E=e.O()}]);